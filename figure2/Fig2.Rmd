---
title: "Fig2"
output: html_document
date: "2025-09-30"
---

library(ggplot2)
library(RColorBrewer)
library(patchwork)
library(ggbeeswarm)
inf="Archaea_S_APT.txt" #通过修改输入文件，生成不同的图

data <- read.table(inf,sep = "\t",header = TRUE)
data[is.na(data)]<-"Unknown"


data$group <- factor(data$group,
                     levels =unique(data$group))
dataA=data[data$Group=="A",]
dataA_order=dataA[order(dataA[,1]),]
data$Term <- factor(data$Term,
                    levels =rev(dataA_order[,2]))

p <- ggplot(data,aes(x=Group,y=Term))+
  geom_point(aes(size=Ratios,color=freq))+
  theme_bw()+theme(panel.grid = element_blank(),panel.border=element_blank())+
  scale_size_continuous("Ratios",limits = c(0,1),breaks = c(0,0.2,0.4,0.6,0.8,1))+
  scale_color_gradient2(low="#FCF6AE",mid="red",high="#361F24",midpoint=30,limits = c(0,65),breaks = c(0,13,26,39,52,65))

p

